<!DOCTYPE html>
<meta charset="utf-8">
<html lang="en-US"> <!-- This element is the root element of an HTML page -->

<head> 
    <title>Bernat Bramon Mora | data scientist</title>
    <meta charset="UTF-8">
    <meta name="description" content="I'm a physicist at heart, a biologist in the books, and data-scientist on LinkedIn. More importantly, I thrive on the process of problem-solving per se, enjoying the simple combination of interesting computational methods and compelling ideas. As a scientist, I've used multiple computational and statistical tools to untangle the complexity that characterizes biological data.">
    <meta name="keywords" content="Network theory, data science, biological complexity, complex networks, community ecology, mathematical modelling, theoretical ecology, data analysis, research, Python, D3, R, C/C++, JavaScript">
    <meta name="author" content="Bernat Bramon Mora">
    <!--<meta http-equiv="refresh" content="100">-->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">

    <script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">

    <link rel='stylesheet' media='screen and (orientation:portrait)' href='css/portrait.css' />
    <link rel='stylesheet' media='screen and (orientation:landscape)' href='css/landscape.css' />


    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KTCPXZ48JE"></script>
    <script>
<<<<<<< HEAD
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-KTCPXZ48JE');
=======
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-KTCPXZ48JE');
>>>>>>> 6be0d2730b00f17fe0491ac0ac4a18e7e69d3121
    </script>

</head>


<body>
<!--<body onload="myFunction()">

<div id="loader"></div>-->

<div id="container" class="svg-container">
    <!--<svg xmlns="https://www.w3.org/2000/svg"></svg>
    <div id="content"></div>-->
</div>

<!--<script type="text/javascript" src="d3/d3.js"></script>-->

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://d3js.org/d3.v4.min.js"></script>

<script>

    function loadHtml(clickedBar){
	     $.ajax({
		type:"GET",
		url: clickedBar,
		mimeType: "text/html; charset=utf-8",
		success: function(result){
		    $("#htmlcontent").html(result);
                    }
		});
    }


    var svg = d3.select("div#container")
            .append("svg").attr("preserveAspectRatio", "xMinYMin meet").attr("viewBox", "0 0 960 960").classed("svg-content", true),
        margin = 20,
        smallr = 3.5,
        fzinitial = "25px",
        fzfocus = "70px",
        diameter = 960

    if (screen.width<400){
        fzinitial = "30px";
    }


    var gtext = svg.append("g").attr("transform", "translate(" + diameter / 2 + "," + diameter / 2 + ")");


//////////////////////////////////LOADER///////////////////////////////////
/*    var svg2 = d3.select("div#loader")
            .append("svg").attr("preserveAspectRatio", "xMinYMin meet").attr("viewBox", "0 0 960 960").classed("svg-content", true);
    var gtext2 = svg2.append("g").attr("transform", "translate(" + diameter / 2 + "," + diameter / 2 + ")");

      gtext2.selectAll("text").data([1], function(d) {return d}).enter().append("text")
        .attr("id", "firstpage1")
        .text("Bernat Bramon Mora")
        .attr("x", 0)             
        .attr("y", -diameter/3.2)
        .attr("text-anchor", "middle")
        .style("font-family", "League Mono");


      gtext2.selectAll("text").data([2], function(d) {return d}).enter().append("text")
        .attr("id", "firstpage2")
        .attr("x", 0)             
        .attr("y", -diameter/4.1)
        .attr("text-anchor", "middle")  
        .style("font-family", "League Mono")
        .style("font-style", "italic")
        .text("PhD student");

      gtext2.selectAll("text").data([3], function(d) {return d}).enter().append("text")
        .attr("id", "firstpage2")
        .attr("x", 0)             
        .attr("y", +diameter/3.5)
        .attr("text-anchor", "middle")  
        .style("font-family", "League Mono")
        .style("font-style", "italic")
        .text("bernat.bramon@gmail.com");

      function degToRad (degrees) {
        return degrees * Math.PI / 180;
      }

      function arcTween(newAngle, angle) {
        return function(d) {
          var interpolate = d3.interpolate(d[angle], newAngle);
        return function(t) {
          d[angle] = interpolate(t);
          return arc(d);
          };
          };
       }

       const animationTime = 1000;
       const loaderRadius = diameter / 7;
       const loaderColor = '#ccc';

       var arc = d3.arc()
           .innerRadius(diameter / 10)
           .outerRadius(loaderRadius);

       var loader = gtext2.append("path")
         .datum({endAngle: 0, startAngle: 0})
         .style("fill", loaderColor)
         .attr("d", arc);

       d3.interval(function() {
         loader.datum({endAngle: 0, startAngle: 0})
  
         loader.transition()
             .duration(animationTime)
             .attrTween("d", arcTween(degToRad(360), 'endAngle'));
  
          loader.transition()
             .delay(animationTime)
             .duration(animationTime)
             .attrTween("d", arcTween(degToRad(360), 'startAngle'));
    }, animationTime * 2);


    var myVar;

    function myFunction() {
         myVar = setTimeout(showPage, 4000);
    }

    function showPage() {
         d3.select("#loader").transition().delay(2000).duration(2000).style("opacity", 0);
         d3.select("#loader").transition().delay(4000).style("display", "none");
    }*/

////////////////////////////////////////////////


      gtext.selectAll("text").data([1], function(d) {return d}).enter().append("text")
        .attr("id", "firstpage1")
        .text("Bernat Bramon Mora")
        .attr("x", 0)             
        .attr("y", -diameter/3.2)
        .attr("text-anchor", "middle")
        .style("font-family", "League Mono");


      gtext.selectAll("text").data([2], function(d) {return d}).enter().append("text")
        .attr("id", "firstpage2")
        .attr("x", 0)             
        .attr("y", -diameter/4.1)
        .attr("text-anchor", "middle")  
        .style("font-family", "League Mono")
        .style("font-style", "italic")
        .text("data scientist");

      gtext.selectAll("text").data([3], function(d) {return d}).enter().append("text")
        .attr("id", "firstpage2")
        .attr("x", 0)             
        .attr("y", +diameter/3.5)
        .attr("text-anchor", "middle")  
        .style("font-family", "League Mono")
        .style("font-style", "italic")
        .text("bernat.bramon(at)gmail.com");


    var g = svg.append("g").attr("transform", "translate(" + diameter / 2 + "," + diameter / 2 + ")");

    var color = d3.scaleLinear()
        .domain([0, 4])
        .range(["hsl(225,80%,80%)", "white"])
        .interpolate(d3.interpolateHcl);

    var pack = d3.pack()
        .size([diameter - margin, diameter - margin])
        .padding(function(d) { 
        return d.data.padding || 2;
        });

    d3.json("flare.json", function(error, root) {
      if (error) throw error;

      var root = d3.hierarchy(root)
          .sum(function(d) { return d.size; })
            .sort(function(a, b) {
                                   return b.data.value-a.data.value; });

      var focus = root,
          nodes_obj = pack(root).descendants(),
          view;

          var isTransition = false;


    //Pattern definitions-------------------------------------------------------

      
      var div = d3.select("div#container").append("div").attr("id","content").style("z-index", -2000)//.style("height", svg.style("height"))
      .insert("div").attr("id", "htmlcontent");
      d3.select("#content").append("div").classed("arrow", true)
          .insert("a")
          .insert("span");
      d3.select("#content").insert("div").attr("id", "blurrystuff_b");
      d3.select("#content").insert("div").attr("id", "blurrystuff_t");

      
      var nodeEnter = g.selectAll("g.node")
        .data(nodes_obj)
        .enter().append("svg:g")
        .attr("id", function(d,i){return "circle-"+i;})
        .attr("class", function(d) { return d.parent ? d.children ? "node" : "node node--leaf" : "node node--root"; })
        //.style("fill", function(d) { return d.depth==1? "url(#grump_avatar)":color(d.depth); })
        .on("click", function(d) {

            if (focus !== d){
                if(!isTransition){
                          isTransition = true;
                          zoom(d);
                          d3.event.stopPropagation()
                }
                };
            })
        .style("display", function(d) { return (d.depth<=focus.depth+1) ? "inline" : "none"; })
        .style("stroke", function(d) { return d.data.stroke;})
        .on("mouseover", function(d) { if (focus==root || focus.depth==1){ d3.select("#foto-0").attr("xlink:href", "images/surfer_blur2.png");}
                                      d3.select(this).style("stroke","black");
                                     })
        .on("mouseout", function(d) { if (focus==root || focus.depth==1){ d3.select("#foto-0").attr("xlink:href", "images/surfer2.png"); }
                                      d3.select(this).style("stroke", function(d) { return d.data.stroke;});
                                     });

      var circle = nodeEnter.append("svg:circle")
        .attr("r", function(d) {d.size})
        .style("fill", function(d) { return d.data.color; })
        .attr("x", function(d) {d.data.x})
        .attr("y", function(d) {d.data.y})
        .style("fill-opacity", function(d) { return (d.depth<=focus.depth) ? 1 : 0; })
        .style("display", function(d) { return (d.depth<=focus.depth+1) ? "inline" : "none"; });


      // Append images
      var images = nodeEnter
        .filter(function(d) {return d.data.switch=="on"})
        .append("svg:image")
        .attr("id", function(d,i) {return "foto-"+i;})
        .attr("xlink:href",  function(d) { return d.data.img;})
        .attr("height", diameter-margin*2)
        .attr("width", diameter-margin*2)
        .attr("x", 0)
        .attr("y", 0)
        .attr("pointer-events", "none")
        .style("opacity", function(d) { return (d.depth<=focus.depth) ? 1 : 0; });

      var text = g.selectAll("text")
        .data(nodes_obj)
        .enter()
        .filter(function(d){return d.data.children;})
        .append("text")
        .attr("class", "label")
        .style("fill-opacity", function(d) { return d.parent === root ? 1 : 0; })
        .style("display", function(d) { return d.parent === root ? "inline" : "none"; })
        .style("text-shadow", "none")
        .style("font-size", fzinitial)
        .text(function(d) { return d.data.name; })
        .attr("dy", function(d) { return d.data.position; });

      var node = g.selectAll("g.node,text.label");

      // Go backwards once if we click on the background of the present node
      svg.style("background", "none")
          .on("click", function() {
              if(!isTransition){
                  isTransition = true;
                  if(focus.depth>1){
                      zoom(focus.parent);
                  }else{
                      zoom(root);
                  }
              }
            });
          
      // Go backwards as well when we click on the margins
      d3.select("body").on("click", function() {
          if(!isTransition){
              isTransition = true;
              if(focus.depth>1){
                  zoom(focus.parent);
              }else{
                  zoom(root);
              }
          }
        });

      zoomTo([root.x, root.y, root.r * smallr *2 + margin]);

      function zoom(d) {
            var focus0 = focus; focus = d;
            var slapse=500, mlapse=1500, llapse=2000;
            var transitionname = "trans".concat("_", focus.depth)

            // This controls how much we are zooming in or out and the speed in which we do so
            var trans = d3.transition(transitionname)
            .duration(d3.event.altKey ? 7500 : mlapse)
            .delay(function(d){
              if(focus==root){
                  return slapse*1.5;
              }else{
                  return slapse;
              }
            })
            .tween("zoom", function(d) {
              if(focus==root){
                  var i = d3.interpolateZoom(view, [focus.data.x, focus.data.y, focus.r *smallr* 2 + margin]);
                  return function(t) { zoomTo(i(t)); };
              }else{
                  if(focus.depth==2){
                  var i = d3.interpolateZoom(view, [focus.data.x, focus.data.y, focus.r * 1.7  + margin]);
                  }else if(focus.depth>2){
                  var i = d3.interpolateZoom(view, [focus.data.x, focus.data.y, focus.r * 1.1  + margin]);
                  }else{
                  var i = d3.interpolateZoom(view, [focus.data.x, focus.data.y, focus.r * 2 + margin]);
                  }
                  return function(t) { zoomTo(i(t)); };
              }
            });

            // As we move in or out, we change the visibility of the nodes, to make them apear or desapear.
            trans.selectAll("g.node")
            .filter(function(d) { return (d.parent===focus)  || this.style.display === "inline"; })
            .delay(slapse)
            .style("fill-opacity", function(d) { return (d.depth<=focus.depth+1) ? 1 : 0; })
            .on("start", function(d) { if (d.depth<=focus.depth+1)  this.style.display = "inline"; })
            .on("end", function(d) { if (d.depth>focus.depth+1)  this.style.display = "none"; });

            if (focus===root){
                trans.selectAll("circle")
                .filter(function(d) { return (d.parent===focus)  || this.style.display === "inline"; })
                .delay(function(d) {return (d.depth==1) ? 0:slapse; })
                .style("fill-opacity", function(d) { return (d.depth<=focus.depth) ? 1 : 0; })
                .on("start", function(d) { if (d.depth<=focus.depth+1)  this.style.display = "inline"; })
                .on("end", function(d) { if (d.depth>focus.depth+1)  this.style.display = "none"; });

                trans.selectAll("image")
                .filter(function(d) { if (focus.depth>=3){
                                          return ((d.depth<=focus.depth+1)  || this.style.display === "inline") && (d.data.name!="Data Skills");
                                      }else{
                                          return (d.depth<=focus.depth+1)  || this.style.display === "inline"; 
                                      }})
                .delay(function(d){return (d.depth==1)? mlapse:slapse})
                .ease(d3.easeLinear).style("opacity", function(d) { return (d.depth<=focus.depth) ? 1 : 0 })
                .on("start", function(d) { if (d.depth<=focus.depth)  this.style.display = "inline"; })
                .on("end", function(d) { if (d.depth>focus.depth)  this.style.display = "none"; });
            }else{
                trans.selectAll("circle")
                .filter(function(d) { return (d.parent===focus)  || this.style.display === "inline"; })
                .delay(function(d){return (d.depth==1)? llapse:slapse})
                .style("fill-opacity", function(d) { return (d.depth<=focus.depth+1) ? 1 : 0; })
                .on("start", function(d) { if (d.depth<=focus.depth+1)  this.style.display = "inline"; })
                .on("end", function(d) { if (d.depth>focus.depth+1)  this.style.display = "none"; });

                trans.selectAll("image")
                .filter(function(d) { if (focus.depth>=3){
                                          return ((d.depth<=focus.depth+1)  || this.style.display === "inline") && (d.data.name!="Data Skills");
                                      }else{
                                          return (d.depth<=focus.depth+1)  || this.style.display === "inline"; 
                                      }})
                .delay(function(d){return (d.depth<=1)? 0:slapse})
                .ease(d3.easeLinear).style("opacity", function(d) { return (d.depth<=focus.depth+1) ? 1 : 0 })
                .on("start", function(d) { if (d.depth<=focus.depth+1)  this.style.display = "inline"; })
                .on("end", function(d) { if (d.depth>focus.depth+1)  this.style.display = "none"; });
            }

            // Remove icon for Data Skills if we go deep
            if(focus.data.name=="Data Skills"){
            d3.select("#foto-4").transition(transitionname).delay(slapse).duration(2*slapse).ease(d3.easeLinear)
              .style("opacity", 0);
            }
            
            // dealing with the text
            // making them appear as we go deeper
            trans.selectAll("text")
            .filter(function(d) { return d.parent === focus && this.style.display !== "inline"; })
            .delay(mlapse)
            .duration(llapse)
            .style("fill-opacity", function(d) { return d.parent === focus ? 1 : 0; })
            .styleTween("display", function() { return d3.interpolate("none", "inline"); });

            // making them disappear or back to normal size as we go deeper or backwards
            trans.selectAll("text")
            .filter(function(d) { return (this.style.display === "inline"); })
            .delay(function(d){return (d.depth<=focus.depth+1 || d===focus)? 300 : slapse; })
            .style("fill-opacity", function(d) {return (d.depth<=focus.depth+1 || d===focus)? 1 : 0; })
            .on("start", function(d) {this.style.diplay = "inline"})
            .on("end", function(d) { if (d.depth>focus.depth+1 && d!==focus) this.style.display = "none"; })
            .attr("dy", function(d) {return  (d.depth<focus.depth)? -600 : d.data.position;})
            .style("font-size", function(d) {return  (d.depth<focus.depth)? fzfocus*2 : fzinitial;});

            // changing size and position to make it a header
            trans.selectAll("text")
            .filter(function(d) { return (this.style.display === "inline") && (d===focus); })
            .delay(slapse+100)
            .attrTween("dy", function(d) { if(focus0.depth==3){return d3.interpolate(-600, -300);}
                                          else{return d3.interpolate(d.data.position, -300);}
                                        })
            .styleTween("font-size", function(){ if(focus0.depth==3){return d3.interpolate(fzfocus*2, fzfocus);}
                                          else{return d3.interpolate(fzinitial, fzfocus);}})
            .filter(function(d) {if(focus.data.name!="Data Skills"){return d.depth == focus.depth && d.depth>1; }
                else{return false;}})
            .style("fill-opacity", 0);

            /*d3.selectAll("images").filter(function(d) { return (d.depth<=focus.depth+1)  || this.style.display === "inline"; })
            .transition().delay(slapse).duration(mlapse).ease(d3.easeLinear)
            .style("opacity", function(d) { return (d==focus) ? 1 : 0; });*/

            var maincircle = d3.selectAll("#foto-0");

            // Load HTML content
            if(focus.children.length==1 && focus!==root){
               if ( focus.depth < 3){
                   trans.select("#htmlcontent").each(function(d){loadHtml(focus.data.name+".html")}).style("display", "inline-block")
                   .on("end", function(){
                         if (this.scrollTop + this.clientHeight >= this.scrollHeight -1){
                             d3.select(".arrow").style("display", "none");
                             d3.select("#blurrystuff_b").style("display", "none");
                             d3.select("#blurrystuff_t").style("background", "linear-gradient(".concat(focus.data.children[0].color,",", focus.data.children[0].colort,"  100%)")).transition(transitionname).style("display", "inline-block");
                             d3.select("#content").style("z-index", 1000);
                         } else if (this.scrollTop <= 1){
                             d3.select(".arrow").transition(transitionname).style("display", "block");
                             d3.select("#blurrystuff_b").style("background", "linear-gradient(".concat(focus.data.children[0].colort,",", focus.data.children[0].color," 100%)")).transition(transitionname).style("display", "inline-block");
                             d3.select("#blurrystuff_t").style("display", "none");
                             d3.select("#content").style("z-index", 1000);
                         }else{
                             d3.select(".arrow").transition(transitionname).style("display", "block");
                             d3.select("#blurrystuff_b").style("background", "linear-gradient(".concat(focus.data.children[0].colort,",", focus.data.children[0].color," 100%)")).transition(transitionname).style("display", "inline-block");
                             d3.select("#blurrystuff_t").style("background", "linear-gradient(".concat(focus.data.children[0].color,",", focus.data.children[0].colort,"  100%)")).transition(transitionname).style("display", "inline-block");
                             d3.select("#content").style("z-index", 1000);
                         }
                     });
               }else{
                   trans.select("#htmlcontent").each(function(d){loadHtml(focus.data.name+".html")}).style("display", "inline-block")
                   .on("end", function(){
                         d3.select(".arrow").style("display", "none");
                         d3.select("#blurrystuff_b").style("display", "none");
                         d3.select("#blurrystuff_t").style("display", "none");
                         d3.select("#content").style("z-index", 1000);
                     });
               }
            }else{
               document.getElementById('htmlcontent').scrollTop=0;
               trans.select("#htmlcontent").style("display", "none");
               trans.select(".arrow").style("display", "none");
               trans.select("#blurrystuff_b").style("display", "none");
               trans.select("#blurrystuff_t").style("display", "none");
               d3.select("#content").style("z-index", -1000);
            }

            if(focus.depth==0){
               d3.selectAll("#firstpage1").transition(transitionname).delay(mlapse).style("opacity", 1);
               d3.selectAll("#firstpage2").transition(transitionname).delay(mlapse).style("opacity", 1);
               maincircle.attr("xlink:href", "images/surfer2.png");
               d3.selectAll("#icons3").transition(transitionname).delay(mlapse).style("opacity", 1);
            }else{
               d3.selectAll("#firstpage1").transition(transitionname).delay(0).duration(mlapse).style("opacity", 0);
               d3.selectAll("#firstpage2").transition(transitionname).delay(0).duration(mlapse).style("opacity", 0);
               maincircle.attr("xlink:href", "images/surfer_blur2.png");
               d3.selectAll("#icons3").transition(transitionname).delay(0).duration(mlapse).style("opacity", 0);
            }

            /*if(focus.depth==0){
                d3.select("body").transition().delay(1000).duration(1000).style("background-color", "white");
            }else if(focus.depth==1){
                d3.select("body").transition().delay(1000).duration(1000).style("background-color", "#969696");
            }else{
                d3.select("body").transition().delay(1000).duration(1000).style("background-color", "#2e3436");
            }*/
            if(focus.depth>1){
                d3.select("body").transition(transitionname).delay(1000).duration(1000).style("background-color", "#2e3436");
                if(focus.depth>2){
                    d3.select("#content").style("padding", "0%");
                }else{
                    d3.select("#content").style("padding-top", "17%").style("padding-left", "12%").style("padding-right", "12%").style("padding-bottom", "17%");
                }
            }else{
                d3.select("body").transition(transitionname).delay(500).duration(1000).style("background-color", "white");
            }
            
            trans.on("end", function(){
                isTransition = false;
            })
            
      }

      
      d3.select("#htmlcontent")
      .on("scroll.scroller", function() {
          if(focus.depth<3){
            if (this.scrollTop + this.clientHeight >= this.scrollHeight-1){
                    d3.select(".arrow").style("display", "none");
                    d3.select("#blurrystuff_b").style("display", "none");
                    d3.select("#blurrystuff_t").style("background", "linear-gradient(".concat(focus.data.children[0].color,",", focus.data.children[0].colort,"  100%)")).style("display", "inline-block");
                } else if (this.scrollTop <= 1){
                    d3.select(".arrow").style("display", "block");
                    d3.select("#blurrystuff_b").style("background", "linear-gradient(".concat(focus.data.children[0].colort,",", focus.data.children[0].color," 100%)")).style("display", "inline-block");
                    d3.select("#blurrystuff_t").style("display", "none");
                } else {
                    d3.select(".arrow").style("display", "block");
                    d3.select("#blurrystuff_b").style("background", "linear-gradient(".concat(focus.data.children[0].colort,",", focus.data.children[0].color," 100%)")).style("display", "inline-block");
                    d3.select("#blurrystuff_t").style("background", "linear-gradient(".concat(focus.data.children[0].color,",", focus.data.children[0].colort,"  100%)")).style("display", "inline-block");
                           
                }
            } else {
                d3.select(".arrow").style("display", "none");
                d3.select("#blurrystuff_b").style("display", "none");
                d3.select("#blurrystuff_t").style("display", "none");
            }
          });
      
      
      
      function zoomTo(v) {
        var k = diameter / v[2]; view = v;
        //node.attr("transform", function(d) { return "translate(" + (d.x - v[0]) * k + "," + (d.y - v[1]) * k + ")"; });
        node.attr("transform", function(d) { return "translate(" + (d.data.x - v[0]) * k + "," + (d.data.y - v[1]) * k + ")"; });
        circle.attr("r", function(d) { return d.r * k; });
        images.attr("width", function(d) { return d.r * 1.99 * k; });
        images.attr("height", function(d) { return d.r *  1.99 * k; });
        images.attr("transform", function(d) { return "translate(" + -0.5 * (d.r * 1.99 * k) + "," + -0.5 * (d.r * 1.99 * k) + ")"; });

      }
    });



</script>

</body>
</html>
